# IBD-SR

## Code for PRL2023 paper  titled "***[Information Bottleneck Disentanglement Based Sparse Representation for Fair Classification](https://www.sciencedirect.com/science/article/pii/S0167865523002489)***"

Unlike current state-of-the-art methods based on data augmentation and adversarial frameworks to solve the fair classification problem, this paper proposes the Information Bottleneck Disentanglement Based Sparse Representation algorithm (IBD-SR) to ensure the fairness of extracted features. The algorithm assumes that each sample is collaboratively generated by a categorical latent variable and a sensitive or category-irrelevant latent variable. To ensure that these two latent variables correctly capture their corresponding features, we impose Information Bottleneck Disentanglement constraints on them. Specifically, the Information Bottleneck is used to obtain more relevant information while compressing the amount of information. Simultaneously, a mutual information minimization constraint enhances their independence. Additionally, by employing the sparse structure, we can further disentangle the discriminative and sensitive information under supervision guidance. Therefore, the algorithm can improve the discrimination of the categorical latent variable as much as possible without extracting the sensitive data into it. Extensive experiments on five public and challenging benchmark datasets reveal the effectiveness of our proposed method, demonstrating that it can ensure fairness without sacrificing classification performance.

|                                                             |                                                           |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| <img src=".\res\04_MNIST-ROT-TSNE-a.jpg" style="zoom:55%;" /> (a) the distribution of $z_c$ under $c$, different colors represent different category labels | <img src="./res/04_MNIST-ROT-TSNE-b.jpg" style="zoom:55%;" /> (b) the distribution of $z_c$ under $s$, different colors represent different sensitive labels |
| <img src="./res/04_MNIST-ROT-TSNE-c.jpg" style="zoom:55%;" /> (c) the distribution of $z_s$ under $c$, different colors represent different category labels | <img src="./res/04_MNIST-ROT-TSNE-d.jpg" style="zoom:55%;" /> (d) the distribution of $z_s$ under $s$, different colors represent different sensitive labels |
| <img src="./res/07_yaleb-TSNE-a.jpg" style="zoom:55%;" /> (e) the distribution of $z_c$ under $c$, different colors represent different category labels | <img src="./res/07_yaleb-TSNE-b.jpg" style="zoom:55%;" /> (f) the distribution of $z_c$ under $s$, different colors represent different sensitive labels |
| <img src="./res/07_yaleb-TSNE-c.jpg" style="zoom:55%;" /> (g) the distribution of $z_s$ under $c$, different colors represent different category labels | <img src="./res/07_yaleb-TSNE-d.jpg" style="zoom:55%;" />  (h) the distribution of $z_s$ under $s$, different colors represent different sensitive labels |

The t-SNE visualization of $z_c$ and $z_s$ corresponding to 5000 samples in the MNIST-ROT test dataset. From (a), $z_{c}$ can be gathered to form different sample clusters according to $c$. While the rotation angle label, as shown in (b), can only produce a relatively uniform distribution, test samples with different rotation angles are distributed in each cluster. Similar rules are also reflected in the (d) and (c).

The t-SNE visualization of $z_c$ and $z_s$ corresponding to 1096 samples in the Extended YaleB test dataset. From (e), $z_{c}$ can be gathered to form different sample clusters according to y. While the sensitive label $s$, as shown in (f), can only produce a relatively uniform distribution, test samples with different sensitive labels are distributed in each cluster. Similar rules are also reflected in the (g) and (h).

# Requirements

The code was tested on Ubuntu 16.04, with Python 3.6 and PyTorch 1.5.

# Citation

Please consider citing this project in your publications if it helps your research. The following is a BibTeX reference. The BibTeX entry requires the url LaTeX package.

```
@article{lu2023information,
  title={Information bottleneck disentanglement based sparse representation for fair classification},
  author={Lu, Xiongbo and Rong, Yi and Chen, Yaxiong and Xiong, Shengwu},
  journal={Pattern Recognition Letters},
  volume={174},
  pages={85--91},
  year={2023},
  publisher={Elsevier}
}
```

# Acknowledge

Some of the codes are built upon [[Unified-Adversarial-Invariance](https://github.com/isi-vista/Unified-Adversarial-Invariance)](https://github.com/isi-vista/Unified-Adversarial-Invariance) and [Variational Sparse Coding](https://github.com/Alfo5123/Variational-Sparse-Coding).

You are encouraged to submit issues and contribute pull requests.
